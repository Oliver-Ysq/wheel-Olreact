{"version":3,"sources":["lib/OlreactDom.js","lib/Olreact.js","index.js"],"names":["render","vnode","container","innerHTML","_render","dom","createDomFromVnode","appendChild","document","createTextNode","type","component","createComponent","config","renderComponent","$root","createElement","setConfig","children","Array","isArray","forEach","vnodeChild","key","test","toLocaleLowerCase","Object","assign","style","console","log","c","constructor","prototype","Olreact","Component","push","parentNode","replaceChild","props","state","OlreactDom","App","name","hobby","newName","setState","update","bind","Foo","updateName","Hobby","sayHi","querySelector"],"mappings":"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","file":"chapter-2.e31bb0bc.js","sourceRoot":"..","sourcesContent":["import Olreact from './Olreact'\r\n\r\nfunction render(vnode, container) {\r\n  container.innerHTML = ''\r\n  _render(vnode, container)\r\n}\r\nfunction _render(vnode, container) {\r\n  let dom = createDomFromVnode(vnode)\r\n  container.appendChild(dom)\r\n}\r\n\r\nfunction createDomFromVnode(vnode) {\r\n  if (typeof vnode === 'string' || typeof vnode === 'number') {\r\n    return document.createTextNode(vnode)\r\n  }\r\n  if (typeof vnode === 'object') {\r\n    if (typeof vnode.type === 'function') {\r\n      let component = createComponent(vnode.type, vnode.config)\r\n      renderComponent(component)\r\n      return component.$root\r\n    }\r\n    let dom = document.createElement(vnode.type)\r\n    setConfig(dom, vnode.config)\r\n    // 如果有子节点\r\n    if (vnode.children && Array.isArray(vnode.children)) {\r\n      vnode.children.forEach(vnodeChild => {\r\n        _render(vnodeChild, dom)\r\n      })\r\n    }\r\n    return dom\r\n  }\r\n}\r\n\r\nfunction setConfig(dom, config) {\r\n  for (let key in config) {\r\n    if (/^on/.test(key)) {  //如果是on开头的事件\r\n      dom[key.toLocaleLowerCase()] = config[key]  //把事件名改为小写，并且作为属性加到dom节点上\r\n    } else if (key === 'style') {     //如果是style\r\n      //把样式信息拷贝到dom.style上。注意：这里必须使用assign，若直接给style赋值不生效。\r\n      Object.assign(dom.style, config[key])\r\n    } else {\r\n      console.log(key)\r\n      dom[key] = config[key]\r\n    }\r\n  }\r\n}\r\n\r\nlet c = []\r\nfunction createComponent(constructor, config) {\r\n  let component\r\n  if (constructor.prototype instanceof Olreact.Component) { //如果是类组件\r\n    component = new constructor(config)//调用类组件，生成实例\r\n  } else {  //如果是函数组件\r\n    component = new Olreact.Component(config)\r\n    component.constructor = constructor\r\n    component.render = function () {\r\n      return this.constructor(config)\r\n    }\r\n  }\r\n  c.push(component)\r\n  return component\r\n}\r\nfunction renderComponent(component) {\r\n  let vnode = component.render()\r\n  let dom = createDomFromVnode(vnode)\r\n\r\n  if (component.$root && component.$root.parentNode) {\r\n    component.$root.parentNode.replaceChild(dom, component.$root)\r\n  }\r\n  component.$root = dom\r\n}\r\nexport default {\r\n  render, renderComponent\r\n}","import OlreactDom from './OlreactDom'\r\nfunction createElement(type, config, ...children) {\r\n  return {\r\n    type, config, children\r\n  }\r\n}\r\nclass Component {\r\n  constructor(props) {\r\n    this.props = props\r\n    this.state = {}\r\n  }\r\n  setState(state) {\r\n    this.state = Object.assign(this.state, state)\r\n    OlreactDom.renderComponent(this)\r\n  }\r\n}\r\n\r\nexport default {\r\n  createElement,\r\n  Component\r\n}","import Olreact from './lib/Olreact'\r\nimport OlreactDom from './lib/OlreactDom'\r\n\r\nclass App extends Olreact.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      name: 'jack',\r\n      hobby: 'swim'\r\n    }\r\n  }\r\n  update(newName) {\r\n    console.log\r\n    this.setState({ name: newName })\r\n  }\r\n  render() {\r\n    return (\r\n      <div>\r\n        <h1>hello world</h1>\r\n        <Foo update={this.update.bind(this)} name={this.state.name}></Foo>\r\n        <Hobby hobby={this.state.hobby} />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nclass Foo extends Olreact.Component {\r\n  updateName() {\r\n    this.props.update('Oliver')\r\n  }\r\n  render() {\r\n    return (\r\n      <div>\r\n        {this.props.name}\r\n        <button onClick={this.updateName.bind(this)}>修改名字</button>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nfunction Hobby(props) {\r\n  let sayHi = () => { console.log('hi') }\r\n  return (\r\n    <p onClick={sayHi}>我的兴趣是{props.hobby}</p>\r\n  )\r\n}\r\n\r\nOlreactDom.render(<App />, document.querySelector('#app'))"]}